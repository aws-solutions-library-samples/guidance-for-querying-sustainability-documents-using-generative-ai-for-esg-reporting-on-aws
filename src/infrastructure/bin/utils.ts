#!/usr/bin/env node
import {
    AwsSolutionsChecks,
    NagSuppressions
} from 'cdk-nag';

import { BucketStack } from '../lib/buckets';
import { LambdaEventStack } from '../lib/lambda-event';

export function supressStatements(bucketStack: BucketStack, lambdaEvent: LambdaEventStack) {
    NagSuppressions.addResourceSuppressions(
        [bucketStack],
        [
            {
                id: 'AwsSolutions-IAM4',
                reason: 'This policy is generated by aws-cdk-lib/aws-s3-deployment',
                appliesTo: [
                    'Policy::arn:<AWS::Partition>:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole'
                ]
            },
            {
                id: 'AwsSolutions-IAM5',
                reason: 'This policy is generated by aws-cdk-lib/aws-s3-deployment',
                appliesTo: [
                    'Resource::*',
                    'Action::s3:DeleteObject*',
                    'Action::s3:Abort*',
                    'Action::s3:GetObject*',
                    'Action::s3:GetBucket*',
                    'Action::s3:List*',
                    'Resource::arn:<AWS::Partition>:s3:::cdk-hnb659fds-assets-<AWS::AccountId>-<AWS::Region>/*',
                    'Resource::<AssetBucket1D025086.Arn>/*'
                ]
            },
            {
                id: 'AwsSolutions-L1',
                reason: 'Suppress error because lambda is using the latest python version: PYTHON_3_12',
            }
        ],
        true
    );

    NagSuppressions.addResourceSuppressions(
        [lambdaEvent],
        [
            {

                id: 'AwsSolutions-IAM4',
                reason: 'This policy is generated by aws-cdk-lib/aws-lambda',
                appliesTo: [
                    'Policy::arn:<AWS::Partition>:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole'
                ]
            },
            {
                id: 'AwsSolutions-IAM5',
                reason: 'This policy is generated by aws-cdk-lib/aws-lambda to auto-attach the AWSLambdaBasicExecutionRole',
                appliesTo: [
                    'Resource::*',
                    'Resource::arn:aws:s3:::S3AssetBucketName/corp-sust-reports/*',
                    'Resource::arn:aws:s3:::S3AssetBucketName/metadata/corp-sust-reports/*'
                ]
            }
        ],
        true
    );
}
